key subroutines of the self-consistent code
